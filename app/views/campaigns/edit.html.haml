- if @campaign.picketable?
  = render 'campaigns/picket/section_cover'
  = render 'campaigns/picket/section_tab', menu: 'content'
- elsif @campaign.template == "sympathy"
  = render "campaigns/header", campaign: @campaign
- else
  = render "campaigns/#{@campaign.template}/section_cover"
  = render "campaigns/#{@campaign.template}/section_tab", menu: 'content'

%section.page-block
  .container
    %ul.nav.nav-tabs.nav-justified{ role: "tablist", style: "margin-bottom: 2em" }
      %li.active{ role: "presentation" }
        %a{ href: "#default", role: "tab", data: { toggle: "tab" }} 기본 설정

      - if exist_partial?("campaigns/#{@campaign.template}/partial_form")
        %li{ role: "presentation" }
          %a{ href: "#detail", role: "tab", data: { toggle: "tab" }} 상세 설정

      %li{ role: "presentation" }
        %a{ href: "#privacy", role: "tab", data: { toggle: "tab" }}
          %i.fa.fa-user
          개인 정보 설정

      - if @campaign.orderable?
        %li{ role: "presentation" }
          = link_to edit_agents_campaign_path(@campaign) do
            %i.fa.fa-envelope
            촉구 대상 설정

      - if @campaign.orderable?
        %li{ role: "presentation" }
          %a{ href: "#agents", role: "tab", data: { toggle: "tab" }} 촉구 관리

      %li{ role: "presentation" }
        %a{ href: "#data", role: "tab", data: { toggle: "tab" } }
          %i.fa.fa-download
            데이터 내려받기

      %li{ role: "presentation" }
        %a.text-danger{ href: "#finish", role: "tab", data: { toggle: "tab" } }
          - if @campaign.closed?
            캠페인 다시 열기
          - else
            %i.fa.fa-ban
            캠페인 종료하기

    .tab-content
      #default.tab-pane.active{ role: "tabpanel"}
        = render 'form'

      #detail.tab-pane
        = form_for @campaign do |f|
          = render_if_exist_partial "campaigns/#{@campaign.template}/_form_detail", f: f
          .form-group
            = f.submit '저장', class: 'btn btn-primary btn-lg btn-block'

      #privacy.tab-pane
        = render 'form_privacy'

      - if @campaign.orderable?
        #agents.tab-pane
          = form_for @campaign do |f|
            = render "campaigns/form_order", f: f
            .form-group
              = f.submit '저장', class: 'btn btn-primary btn-lg btn-block'

      #data.tab-pane
        - if @campaign.signs.any?
          = link_to data_campaign_path(@campaign, format: :xlsx), class: 'btn btn-primary' do
            %i.fa.fa-download
            서명 참여 데이터 내려받기

        - if @campaign.comments.any?
          = link_to comments_data_campaign_path(@campaign, format: :xlsx), class: 'btn btn-primary' do
            %i.fa.fa-download
            의견 참여 데이터

        - if @campaign.agents.any?
          = link_to orders_data_campaign_path(@campaign, format: :xlsx), class: 'btn btn-primary' do
            %i.fa.fa-download
            촉구 참여 데이터

      #finish.tab-pane
        .page-header
          %h2 캠페인 삭제
          %small 캠페인을 완전히 삭제합니다. 이 작업을 되돌릴 수 없습니다.
        = link_to @campaign, method: :delete, data: { confirm: '삭제하시겠습니까?' }, class: "btn btn-block btn-danger" do
          %i.fa.fa-trash
          캠페인 삭제

        - if @campaign.closed?
          .page-header
            %h2 #{Campaign.model_name.human} 다시 열기
            %small 캠페인을 다시 열고 참여를 받습니다.
          = link_to open_campaign_path(@campaign), method: :put, class: 'btn btn-block btn-danger', data: { disable: '정말 다시 여시겠습니까?' } do
            다시 열기

        - else
          .page-header
            %h2 #{Campaign.model_name.human} 종료
            %small 캠페인을 종료하고 더이상 참여를 받지 않습니다.
          = link_to close_campaign_path(@campaign), method: :put, class: 'btn btn-block btn-danger', data: { disable: '정말 종료하시겠습니까?' } do
            종료하기
