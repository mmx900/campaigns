%a{id: "anchor-speakers"}

- @petition.total_action_assignables.each do |action_assignable|
  - next if action_assignable.statementable_speakers(@petition).empty?

  - current_speakers = action_assignable.statementable_speakers_moderatly(@petition, 30)

  - speakers_group = current_speakers.to_a.group_by { |speaker| petition.spoken?(speaker) }
  - speakers_spoken = @petition.action_assignable_speakers_spoken(action_assignable)
  - speakers_unspoken = @petition.action_assignable_speakers_unspoken(action_assignable)

  - if speakers_spoken.any?
    %h5.text-muted 관련 인물 답변
    %div
      - speakers_spoken.each do |speaker|
        = render 'statementables/speaker', speaker: speaker, statementable: petition

  - if @petition.statements.responed_body.any?
    .panel.panel-opinion.panel-default{ style: 'background-color: #fff; border: none; line-height: 1.5;' }
      - @petition.statements.responed_body.recent.each do |statement|
        .panel-body[statement]
          .panel-post__statements
            - speaker = statement.speaker
            .media[statement]
              .media-left
                = link_to speaker_path(speaker) do
                  .media-object.image{style: "background-image: url(#{speaker.image.xs.url}); background-size:cover; background-repeat: no-repeat; background-position: top; width: 24px; height: 24px;"}

              .media-body
                - if statement.stance.present?
                  %h4.media-heading{ style: 'line-height: 24px;' }
                    = link_to speaker_path(speaker) do
                      %strong= speaker.name
                    %span.text-muted= speaker.organization
                    %span.text-success= statement.stance.text

            - if statement.body.present?
              .opinion__body{ style: 'font-weight: normal;' }
                != statement.body

  - if speakers_unspoken.any?
    - if speakers_spoken.any?
      %h5.text-muted 관련 인물에게 촉구하기
      %div
        - speakers_unspoken.each do |speaker|
          = render 'statementables/speaker', speaker: speaker, statementable: petition
