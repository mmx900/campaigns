- if @petition.project
  = render 'projects/header', project: @petition.project

%section#petition-block.page-block
  .container
    .panel.panel-default.panel-post
      - cover_image = @petition.cover_image_url(:lg)
      .panel-heading
        %h2
          %small.label.label-default
            = Petition.model_name.human
          %br
          = @petition.title

        %h4.users-count
          %span
            %i.fa.fa-user-o
            = @petition.signs_count
            명 참여

        %p
          = link_to @petition.user.nickname
          %span.panel-post__date
            = date_f @petition.created_at
          - if can? :edit, @petition
            = link_to '수정', edit_petition_path(@petition)
          - if can? :destroy, @petition
            = link_to '삭제', @petition, method: :delete, data: { confirm: '삭제하시겠습니까?' }
          조회 #{@petition.views_count}

      .panel-body
        .panel-post__body
          = raw @petition.body

      .panel-body
        .panel-post__signs
          = render 'signs/list', petition: @petition

      .panel-body
        .panel-post__share
          %h4 이 이슈를 친구들에게 알려 주세요
          .share-box{ 'data-share-image': image_url(cover_image) }
          %input{value: "<iframe width='100%' height='800' src='#{petition_url(@petition, mode: :widget)}' frameborder='0'></iframe>", class: 'form-control'}

      - if @petition.comment_enabled
        .panel-body
          .panel-post__comments
            = render 'comments/list', commentable: @petition

- if flash[:sign_notice].present?
  #sign-success-modal.modal.fade{:role => "dialog", :tabindex => "0"}
    .modal-dialog{:role => "document"}
      .modal-content
        .modal-header
          %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
            %span{"aria-hidden" => "true"} &#215;
          %h4.modal-title
            서명 성공
        .modal-body
          != flash[:sign_notice]
          .share-box{ 'data-share-image': image_url(cover_image) }

  = content_for :script do
    :javascript
      $(function(){
        $('#sign-success-modal').modal('show');
      });
  - flash.delete(:sign_notice)
